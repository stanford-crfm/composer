algorithms: []
command: 'git clone {{ git_repo }} $HOME/composer

  cd $HOME/composer

  echo ''Checking out composer branch {{ git_branch }}''

  git checkout {{ git_branch }}

  pip3 install braceexpand zstandard torch==1.11 torchvision torchaudio --extra-index-url
  https://download.pytorch.org/whl/cu113

  pip install --user -e .[all]

  composer -n 8 examples/run_composer_trainer.py -f /mnt/config/parameters.yaml --run_name
  {{ name }}

  '
git_branch: multinode_gpt2
git_repo: https://github.com/stanford-crfm/composer
image: mosaicml/pytorch
instance: r6z1-g8-a100
models: mistral_weighted_gpt2_11m
name: miniallpubmed-pubmedabs2-pubmedc19-medical13-nih12
parameters:
  callbacks:
  - lr_monitor: {}
  - loss_scale_monitor: {}
  - grad_monitor:
      log_layer_grad_norms: true
  - lr_monitor: {}
  - speed_monitor:
      window_size: 10
  loggers:
  - wandb:
      entity: stanford-mercury
      log_artifacts: true
      project: mosaic-gpt2
  save_artifact_name: '{run_name}/checkpoints/rank{rank}'
  save_folder: /tmp/{run_name}
  save_interval: 20000ba
  save_num_checkpoints_to_keep: 1
  seed: 1
  train_dataset:
    sprucfluo:
      weights:
        academic: 0.0
        books: 0.0
        enron: 0.0
        europarl: 0.0
        gutenberg: 0.0
        hackernews: 0.0
        law: 0.0
        medical: 0.13118209952783916
        nih: 0.12411699037691273
        pubmedAbs: 0.20332012668884777
        pubmedC: 0.19313113425060294
        stack_exchange: 0.0
        subtitles: 0.012203141811528602
        ubuntu_irc: 0.0
        uspto: 0.0
        webtext: 0.0072552518461912845
        wikipedia: 0.3287912554980774
project: mosaic-gpt2
